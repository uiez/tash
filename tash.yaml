templates:
  build:
    - condition:
        value: $GOOS
        compare: windows
        actions:
          - env:
              value: EXECUTABLE_EXT=.exe
    - cmd:
        exec: go build -ldflags "-w -s" -o tash_${GOOS}_${GOARCH}$EXECUTABLE_EXT

tasks:
  darwin:
    description: |-
      build darwin binary
    args:
      - env: GOARCH
        description: build architecture, amd64 or 386
        default: amd64
    actions:
      - env:
          value: GOOS=darwin
      - template: build

  linux:
    description: |-
      build linux binary
    args:
      - env: GOARCH
        description: build architecture, amd64 or 386
        default: amd64
    actions:
      - env:
          value: GOOS=linux
      - template: build

  windows:
    description: |-
      build windows binary
    args:
      - env: GOARCH
        description: build architecture, amd64 or 386
        default: amd64
    actions:
      - env:
          value: GOOS=windows
      - template: build
  all:
    depends: [darwin, linux, windows]
